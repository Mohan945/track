SET TERMOUT OFF
SET HEADING ON
SET FEEDBACK OFF
SET ECHO OFF
SET LINESIZE 1000
SET PAGESIZE 50000
SET COLSEP ","
SPOOL user_report.csv

SELECT 
    u.username,
    TO_CHAR(u.last_login, 'YYYY-MM-DD HH24:MI:SS') AS last_login,
    CASE 
        WHEN o.owner IS NOT NULL THEN 'YES'
        ELSE 'NO'
    END AS has_objects
FROM 
    dba_users u
LEFT JOIN (
    SELECT DISTINCT owner FROM dba_objects
) o ON u.username = o.owner
WHERE 
    u.username IN (
        'CO71264','CO70231','CO70239','CO71101','CO71919','CO70894','CO70080',
        'CO70159','CO71257','CO72639','CO73568','CO72177','CO72546','CO72550',
        'SLDP72','SLCD48','SLC658','CO71205','SL291R','CO62451','SLDG59',
        'CIA_SANDBOX_SL014P','SLFB74','SLFC24','CUSTOMERPLATFORM_SL121L',
        'SL449L','CUSTOMERPLATFORM_BEN_SL614C','SL614C','SL339G','SLD689',
        'SLG506','CUSTOMERPLATFORM_BEN_SL209Q','RG_SL209Q','CO72254','CO72635',
        'CO72945','SLBX75','SLCD20','SLH757','SLEN62','SLD990','CO60925',
        'SLCL46','SLW460','SLW035','SLCC43','SLEP07','CO73080','CO68374',
        'SLC062','CO70489','CO71189','CO74082','CO74101','CO70964','CO73039',
        'CO72315','CO73442','SLW097','CO72749','CO70684','CO72799','SLBV64',
        'SLFB56','SLES05','CO70210','CO72672'
    )
ORDER BY u.username;

SPOOL OFF
SET COLSEP " "
SET TERMOUT ON
PROMPT CSV File Generated: user_report.csv
